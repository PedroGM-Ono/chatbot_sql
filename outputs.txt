Pergunte algo sobre as vendas (ou 'sair' para encerrar):

Sua pergunta: Qual o faturamento total por produto?
-------------LLM INFO-----------------
<class 'llama_cpp.llama.Llama'>
<llama_cpp.llama.Llama object at 0x70e702437530>
----------------------------------------
-------------Translator-----------------
Qual o faturamento total por produto?
What is the total revenue per product?
----------------------------------------
------------Prompt-----------
[INST]
You are an expert in writing SQL queries for SQLite databases.
Below is the schema of the database:

Table clients:
client_id: INTEGER
name: TEXT

Table products:
product_id: INTEGER
name: TEXT
category: TEXT
unit_price: INTEGER

Table sales:
date: TEXT
product_id: INTEGER
client_id: INTEGER
seller_id: INTEGER
store_id: INTEGER
quantity: INTEGER
payment: TEXT
status: TEXT
sale_id: INTEGER

Table sellers:
seller_id: INTEGER
name: TEXT

Table stores:
store: INTEGER
region: TEXT
address: TEXT

Your task:
Write a single valid SQLite query that answers the following question:

What is the total revenue per product?

Instructions:
- Use JOINs where needed, explicitly referencing table and column names.
- Always use the correct table for each field based on the schema above.
- Prefer names (e.g. product name, client name) instead of IDs in the output when applicable.
- Use full SQL syntax.
- Return only the SQLite query enclosed in triple backticks (```).
- DO NOT return anything else — no comments, no explanations.
- The field sales.date is stored as TEXT in format d/m/Y H:M
[/INST]
----------------------------
----------------LLM Output--------------
{'id': 'cmpl-e8ecb9f5-4687-4fbb-ba2a-1bd9c74f33a4', 'object': 'text_completion', 'created': 1750536006, 'model': 'models/mistral-7b-instruct-v0.1.Q4_K_M.gguf', 'choices': [{'text': ' ```sql\nSELECT products.name, SUM(products.unit_price * sales.quantity) AS total_revenue\nFROM products\nJOIN sales ON products.product_id = sales.product_id\nGROUP BY products.name;\n```', 'index': 0, 'logprobs': None, 'finish_reason': 'stop'}], 'usage': {'prompt_tokens': 339, 'completion_tokens': 56, 'total_tokens': 395}}
----------------------------------------
-------Query gerada-------
 ```sql
SELECT products.name, SUM(products.unit_price * sales.quantity) AS total_revenue
FROM products
JOIN sales ON products.product_id = sales.product_id
GROUP BY products.name;
```
--------------------------
-------Query executada-------
SELECT products.name, SUM(products.unit_price * sales.quantity) AS total_revenue
FROM products
JOIN sales ON products.product_id = sales.product_id
GROUP BY products.name;

--------------------------

Resultado:
                                  name  total_revenue
0                 Air Fryer Mondial 4L         533630
1               Aspirador de Pó Philco         483420
2                  Bicicleta Caloi 100        1759800
3           Bola de Futebol Nike Campo         271400
4                 Boné New Era Yankees         235440
5     Cafeteira Nespresso Essenza Mini         619320
6                Caixa de Som JBL Go 3         271170
7               Calça Legging Nike Pro         381080
8   Carregador Portátil Anker 10000mAh         222660
9                Console PlayStation 5        2227005
10              Câmera Canon EOS Rebel        2185600
11                    Drone DJI Mini 2        1913953
12           Esteira Elétrica Movement        1886850
13                Fogão Consul 4 bocas        1258100
14       Fone Bluetooth Samsung Buds 2         769599
15                  Fone de Ouvido JBL         395150
16             Geladeira Brastemp 375L        2252250
17       Headset Gamer HyperX Cloud II         598520
18      Impressora Epson EcoTank L3250        1355165
19               Impressora HP DeskJet         593760
20          Jaqueta Corta Vento Adidas         522900
21              Micro-ondas Electrolux         786160
22        Mochila Lenovo para notebook         184200
23                      Monitor LG 24"        1165200
24     Mouse Gamer Razer DeathAdder V2         368960
25                 Mouse Logitech M170          92025
26               Máquina de Lavar 11kg        1660600
27              Notebook Dell Inspiron        2515500
28       Patins Rollerblade Zetrablade        1023961
29      Placa de Vídeo Nvidia RTX 4060        2291045
30           Relógio Smartwatch Xiaomi         518400
31                SSD Kingston NV2 1TB         600480
32                Smart TV Samsung 50"        1992300
33         Smartphone Motorola Edge 40        2425726
34              Smartphone Samsung A34        1732437
35                Smartphone iPhone 14         224970
36            Soundbar Samsung HW-T450        1294704
37     Teclado Logitech K380 Bluetooth         280500
38           Teclado Mecânico Redragon         297750
39               Tênis Nike Revolution         407040
40             Ventilador Mondial 40cm         246800
41      Óculos de Sol Ray-Ban Wayfarer         761360

Sua pergunta: Qual o total de vendas por produto?
-------------LLM INFO-----------------
<class 'llama_cpp.llama.Llama'>
<llama_cpp.llama.Llama object at 0x70e6e7ce3290>
----------------------------------------
-------------Translator-----------------
Qual o total de vendas por produto?
What is the total sales per product?
----------------------------------------
------------Prompt-----------
[INST]
You are an expert in writing SQL queries for SQLite databases.
Below is the schema of the database:

Table clients:
client_id: INTEGER
name: TEXT

Table products:
product_id: INTEGER
name: TEXT
category: TEXT
unit_price: INTEGER

Table sales:
date: TEXT
product_id: INTEGER
client_id: INTEGER
seller_id: INTEGER
store_id: INTEGER
quantity: INTEGER
payment: TEXT
status: TEXT
sale_id: INTEGER

Table sellers:
seller_id: INTEGER
name: TEXT

Table stores:
store: INTEGER
region: TEXT
address: TEXT

Your task:
Write a single valid SQLite query that answers the following question:

What is the total sales per product?

Instructions:
- Use JOINs where needed, explicitly referencing table and column names.
- Always use the correct table for each field based on the schema above.
- Prefer names (e.g. product name, client name) instead of IDs in the output when applicable.
- Use full SQL syntax.
- Return only the SQLite query enclosed in triple backticks (```).
- DO NOT return anything else — no comments, no explanations.
- The field sales.date is stored as TEXT in format d/m/Y H:M
[/INST]
----------------------------
----------------LLM Output--------------
{'id': 'cmpl-81d5870a-c9f6-4479-bf92-b83746263d9d', 'object': 'text_completion', 'created': 1750536089, 'model': 'models/mistral-7b-instruct-v0.1.Q4_K_M.gguf', 'choices': [{'text': ' ```sql\nSELECT products.name, SUM(sales.quantity) AS total_sales\nFROM clients\nJOIN sales ON clients.client_id = sales.client_id\nJOIN products ON sales.product_id = products.product_id\nGROUP BY products.name;\n```', 'index': 0, 'logprobs': None, 'finish_reason': 'stop'}], 'usage': {'prompt_tokens': 339, 'completion_tokens': 67, 'total_tokens': 406}}
----------------------------------------
-------Query gerada-------
 ```sql
SELECT products.name, SUM(sales.quantity) AS total_sales
FROM clients
JOIN sales ON clients.client_id = sales.client_id
JOIN products ON sales.product_id = products.product_id
GROUP BY products.name;
```
--------------------------
-------Query executada-------
SELECT products.name, SUM(sales.quantity) AS total_sales
FROM clients
JOIN sales ON clients.client_id = sales.client_id
JOIN products ON sales.product_id = products.product_id
GROUP BY products.name;

--------------------------

Resultado:
                                  name  total_sales
0                 Air Fryer Mondial 4L         1241
1               Aspirador de Pó Philco         1151
2                  Bicicleta Caloi 100          838
3           Bola de Futebol Nike Campo         1180
4                 Boné New Era Yankees         1308
5     Cafeteira Nespresso Essenza Mini         1191
6                Caixa de Som JBL Go 3         1179
7               Calça Legging Nike Pro         1361
8   Carregador Portátil Anker 10000mAh         1237
9                Console PlayStation 5          495
10              Câmera Canon EOS Rebel          683
11                    Drone DJI Mini 2          547
12           Esteira Elétrica Movement          315
13                Fogão Consul 4 bocas         1094
14       Fone Bluetooth Samsung Buds 2         1101
15                  Fone de Ouvido JBL         1129
16             Geladeira Brastemp 375L          585
17       Headset Gamer HyperX Cloud II         1151
18      Impressora Epson EcoTank L3250         1085
19               Impressora HP DeskJet         1237
20          Jaqueta Corta Vento Adidas         1162
21              Micro-ondas Electrolux         1268
22        Mochila Lenovo para notebook         1228
23                      Monitor LG 24"          971
24     Mouse Gamer Razer DeathAdder V2         1153
25                 Mouse Logitech M170         1227
26               Máquina de Lavar 11kg          722
27              Notebook Dell Inspiron          559
28       Patins Rollerblade Zetrablade         1139
29      Placa de Vídeo Nvidia RTX 4060          955
30           Relógio Smartwatch Xiaomi         1080
31                SSD Kingston NV2 1TB         1251
32                Smart TV Samsung 50"          687
33         Smartphone Motorola Edge 40          674
34              Smartphone Samsung A34          963
35                Smartphone iPhone 14           30
36            Soundbar Samsung HW-T450         1296
37     Teclado Logitech K380 Bluetooth         1122
38           Teclado Mecânico Redragon         1191
39               Tênis Nike Revolution         1272
40             Ventilador Mondial 40cm         1234
41      Óculos de Sol Ray-Ban Wayfarer         1228

Sua pergunta: Qual o faturamento total por loja?
-------------LLM INFO-----------------
<class 'llama_cpp.llama.Llama'>
<llama_cpp.llama.Llama object at 0x70e6e9779250>
----------------------------------------
-------------Translator-----------------
Qual o faturamento total por loja?
What is the total revenue per store?
----------------------------------------
------------Prompt-----------
[INST]
You are an expert in writing SQL queries for SQLite databases.
Below is the schema of the database:

Table clients:
client_id: INTEGER
name: TEXT

Table products:
product_id: INTEGER
name: TEXT
category: TEXT
unit_price: INTEGER

Table sales:
date: TEXT
product_id: INTEGER
client_id: INTEGER
seller_id: INTEGER
store_id: INTEGER
quantity: INTEGER
payment: TEXT
status: TEXT
sale_id: INTEGER

Table sellers:
seller_id: INTEGER
name: TEXT

Table stores:
store: INTEGER
region: TEXT
address: TEXT

Your task:
Write a single valid SQLite query that answers the following question:

What is the total revenue per store?

Instructions:
- Use JOINs where needed, explicitly referencing table and column names.
- Always use the correct table for each field based on the schema above.
- Prefer names (e.g. product name, client name) instead of IDs in the output when applicable.
- Use full SQL syntax.
- Return only the SQLite query enclosed in triple backticks (```).
- DO NOT return anything else — no comments, no explanations.
- The field sales.date is stored as TEXT in format d/m/Y H:M
[/INST]
----------------------------
----------------LLM Output--------------
{'id': 'cmpl-f0a9d0f6-d09c-4538-98c7-efd96ec4e07f', 'object': 'text_completion', 'created': 1750536257, 'model': 'models/mistral-7b-instruct-v0.1.Q4_K_M.gguf', 'choices': [{'text': ' ```sql\nSELECT stores.region, stores.address, SUM(sales.quantity * products.unit_price) AS total_revenue\nFROM sales\nJOIN clients ON sales.client_id = clients.client_id\nJOIN products ON sales.product_id = products.product_id\nJOIN stores ON sales.store_id = stores.store\nGROUP BY stores.region, stores.address;\n```', 'index': 0, 'logprobs': None, 'finish_reason': 'stop'}], 'usage': {'prompt_tokens': 339, 'completion_tokens': 95, 'total_tokens': 434}}
----------------------------------------
-------Query gerada-------
 ```sql
SELECT stores.region, stores.address, SUM(sales.quantity * products.unit_price) AS total_revenue
FROM sales
JOIN clients ON sales.client_id = clients.client_id
JOIN products ON sales.product_id = products.product_id
JOIN stores ON sales.store_id = stores.store
GROUP BY stores.region, stores.address;
```
--------------------------
-------Query executada-------
SELECT stores.region, stores.address, SUM(sales.quantity * products.unit_price) AS total_revenue
FROM sales
JOIN clients ON sales.client_id = clients.client_id
JOIN products ON sales.product_id = products.product_id
JOIN stores ON sales.store_id = stores.store
GROUP BY stores.region, stores.address;

--------------------------

Resultado:
          region                                            address  total_revenue
0   Centro-Oeste  Estação Almeida, 45, Vila Independencia 3ª Seç...        1227703
1   Centro-Oeste  Recanto Azevedo, 79, Ventosa, 77622021 Araújo ...        1306735
2   Centro-Oeste  Rodovia de Monteiro, Novo Tupi, 03412750 Viana...         969259
3       Nordeste  Chácara Vargas, 55, Santa Terezinha, 90769890 ...        4201956
4       Nordeste  Ladeira Moraes, 47, Luxemburgo, 57679-546 Mont...        3517340
5       Nordeste  Vale Mariane Vargas, 1, Universitário, 71041-2...        3251178
6          Norte  Esplanada de Peixoto, 82, Boa Vista, 28204750 ...        1217352
7          Norte  Loteamento Silva, 89, Vila Barragem Santa Lúci...        1159089
8          Norte  Via Olívia Fernandes, Vila Das Oliveiras, 3338...         831412
9        Sudeste  Feira de Jesus, Cinquentenário, 96460847 Rocha...        6234515
10       Sudeste  Lago João Costela, 95, Pompéia, 24286-130 Nova...        5715486
11       Sudeste  Praça Barbosa, 7, Delta, 15298061 da Cunha de ...        5893527
12           Sul  Estação de Campos, 53, Vila Piratininga, 24326...        2088703
13           Sul  Lagoa Borges, 29, Vila Santa Rosa, 34686297 Na...        1871971
14           Sul  Trevo de Ferreira, 68, Santana Do Cafezal, 261...        2120664

Sua pergunta: Quais os vendedores com os maiores números de pedidos?
-------------LLM INFO-----------------
<class 'llama_cpp.llama.Llama'>
<llama_cpp.llama.Llama object at 0x70e6e8322300>
----------------------------------------
-------------Translator-----------------
Quais os vendedores com os maiores números de pedidos?
Which sellers have the highest number of orders?
----------------------------------------
------------Prompt-----------
[INST]
You are an expert in writing SQL queries for SQLite databases.
Below is the schema of the database:

Table clients:
client_id: INTEGER
name: TEXT

Table products:
product_id: INTEGER
name: TEXT
category: TEXT
unit_price: INTEGER

Table sales:
date: TEXT
product_id: INTEGER
client_id: INTEGER
seller_id: INTEGER
store_id: INTEGER
quantity: INTEGER
payment: TEXT
status: TEXT
sale_id: INTEGER

Table sellers:
seller_id: INTEGER
name: TEXT

Table stores:
store: INTEGER
region: TEXT
address: TEXT

Your task:
Write a single valid SQLite query that answers the following question:

Which sellers have the highest number of orders?

Instructions:
- Use JOINs where needed, explicitly referencing table and column names.
- Always use the correct table for each field based on the schema above.
- Prefer names (e.g. product name, client name) instead of IDs in the output when applicable.
- Use full SQL syntax.
- Return only the SQLite query enclosed in triple backticks (```).
- DO NOT return anything else — no comments, no explanations.
- The field sales.date is stored as TEXT in format d/m/Y H:M
[/INST]
----------------------------
----------------LLM Output--------------
{'id': 'cmpl-de8d88bc-ba84-439d-b307-3c46ccfb1eeb', 'object': 'text_completion', 'created': 1750536487, 'model': 'models/mistral-7b-instruct-v0.1.Q4_K_M.gguf', 'choices': [{'text': ' ```sql\nSELECT sellers.name, COUNT(*) as order_count\nFROM sales\nINNER JOIN sellers ON sales.seller_id = sellers.seller_id\nINNER JOIN clients ON sales.client_id = clients.client_id\nGROUP BY sellers.name\nORDER BY order_count DESC;\n```', 'index': 0, 'logprobs': None, 'finish_reason': 'stop'}], 'usage': {'prompt_tokens': 341, 'completion_tokens': 79, 'total_tokens': 420}}
----------------------------------------
-------Query gerada-------
 ```sql
SELECT sellers.name, COUNT(*) as order_count
FROM sales
INNER JOIN sellers ON sales.seller_id = sellers.seller_id
INNER JOIN clients ON sales.client_id = clients.client_id
GROUP BY sellers.name
ORDER BY order_count DESC;
```
--------------------------
-------Query executada-------
SELECT sellers.name, COUNT(*) as order_count
FROM sales
INNER JOIN sellers ON sales.seller_id = sellers.seller_id
INNER JOIN clients ON sales.client_id = clients.client_id
GROUP BY sellers.name
ORDER BY order_count DESC;

--------------------------

Resultado:
      name  order_count
0  Cecília          910
1    Alice          895
2  Antônio          884
3   Samuel          869
4   Helena          866
5    Artur          852
6   Miguel          841
7     Davi          823
8    Laura          819
9    Maitê          814

Sua pergunta: Qual o número de vendas por forma de pagamento?
-------------LLM INFO-----------------
<class 'llama_cpp.llama.Llama'>
<llama_cpp.llama.Llama object at 0x70e6e86099a0>
----------------------------------------
-------------Translator-----------------
Qual o número de vendas por forma de pagamento?
What is the number of sales per payment method?
----------------------------------------
------------Prompt-----------
[INST]
You are an expert in writing SQL queries for SQLite databases.
Below is the schema of the database:

Table clients:
client_id: INTEGER
name: TEXT

Table products:
product_id: INTEGER
name: TEXT
category: TEXT
unit_price: INTEGER

Table sales:
date: TEXT
product_id: INTEGER
client_id: INTEGER
seller_id: INTEGER
store_id: INTEGER
quantity: INTEGER
payment: TEXT
status: TEXT
sale_id: INTEGER

Table sellers:
seller_id: INTEGER
name: TEXT

Table stores:
store: INTEGER
region: TEXT
address: TEXT

Your task:
Write a single valid SQLite query that answers the following question:

What is the number of sales per payment method?

Instructions:
- Use JOINs where needed, explicitly referencing table and column names.
- Always use the correct table for each field based on the schema above.
- Prefer names (e.g. product name, client name) instead of IDs in the output when applicable.
- Use full SQL syntax.
- Return only the SQLite query enclosed in triple backticks (```).
- DO NOT return anything else — no comments, no explanations.
- The field sales.date is stored as TEXT in format d/m/Y H:M
[/INST]
----------------------------
----------------LLM Output--------------
{'id': 'cmpl-091de0f7-2f48-4de4-8e07-3fd83dd24bb0', 'object': 'text_completion', 'created': 1750536573, 'model': 'models/mistral-7b-instruct-v0.1.Q4_K_M.gguf', 'choices': [{'text': ' ```sql\nSELECT \n    payment,\n    COUNT(*) AS sales_count\nFROM \n    sales\nGROUP BY \n    payment;\n```', 'index': 0, 'logprobs': None, 'finish_reason': 'stop'}], 'usage': {'prompt_tokens': 341, 'completion_tokens': 36, 'total_tokens': 377}}
----------------------------------------
-------Query gerada-------
 ```sql
SELECT 
    payment,
    COUNT(*) AS sales_count
FROM 
    sales
GROUP BY 
    payment;
```
--------------------------
-------Query executada-------
SELECT 
    payment,
    COUNT(*) AS sales_count
FROM 
    sales
GROUP BY 
    payment;

--------------------------

Resultado:
   payment  sales_count
0     None         1747
1   Boleto         1685
2  Crédito         1777
3   Débito         1711
4      Pix         1653

Sua pergunta: Qual o faturamento por categoria de produto?
-------------LLM INFO-----------------
<class 'llama_cpp.llama.Llama'>
<llama_cpp.llama.Llama object at 0x70e6e7a7bfe0>
----------------------------------------
-------------Translator-----------------
Qual o faturamento por categoria de produto?
What is the billing by product category?
----------------------------------------
------------Prompt-----------
[INST]
You are an expert in writing SQL queries for SQLite databases.
Below is the schema of the database:

Table clients:
client_id: INTEGER
name: TEXT

Table products:
product_id: INTEGER
name: TEXT
category: TEXT
unit_price: INTEGER

Table sales:
date: TEXT
product_id: INTEGER
client_id: INTEGER
seller_id: INTEGER
store_id: INTEGER
quantity: INTEGER
payment: TEXT
status: TEXT
sale_id: INTEGER

Table sellers:
seller_id: INTEGER
name: TEXT

Table stores:
store: INTEGER
region: TEXT
address: TEXT

Your task:
Write a single valid SQLite query that answers the following question:

What is the billing by product category?

Instructions:
- Use JOINs where needed, explicitly referencing table and column names.
- Always use the correct table for each field based on the schema above.
- Prefer names (e.g. product name, client name) instead of IDs in the output when applicable.
- Use full SQL syntax.
- Return only the SQLite query enclosed in triple backticks (```).
- DO NOT return anything else — no comments, no explanations.
- The field sales.date is stored as TEXT in format d/m/Y H:M
[/INST]
----------------------------
----------------LLM Output--------------
{'id': 'cmpl-087e6ddb-718e-4375-85f7-144debe4245b', 'object': 'text_completion', 'created': 1750536767, 'model': 'models/mistral-7b-instruct-v0.1.Q4_K_M.gguf', 'choices': [{'text': ' ```sql\nSELECT products.category, SUM(sales.quantity * products.unit_price) AS total_billing\nFROM sales\nJOIN products ON sales.product_id = products.product_id\nGROUP BY products.category;\n```', 'index': 0, 'logprobs': None, 'finish_reason': 'stop'}], 'usage': {'prompt_tokens': 340, 'completion_tokens': 57, 'total_tokens': 397}}
----------------------------------------
-------Query gerada-------
 ```sql
SELECT products.category, SUM(sales.quantity * products.unit_price) AS total_billing
FROM sales
JOIN products ON sales.product_id = products.product_id
GROUP BY products.category;
```
--------------------------
-------Query executada-------
SELECT products.category, SUM(sales.quantity * products.unit_price) AS total_billing
FROM sales
JOIN products ON sales.product_id = products.product_id
GROUP BY products.category;

--------------------------

Resultado:
            category  total_billing
0         Acessórios        1686620
1   Eletrodomésticos        5957110
2    Eletroportáteis        1883170
3        Eletrônicos        8318858
4           Esportes        4942011
5        Impressoras        1948925
6        Informática        6572225
7        Periféricos        1039235
8          Telefonia        5152732
9          Vestuário        1546460
10             Áudio        2559544
